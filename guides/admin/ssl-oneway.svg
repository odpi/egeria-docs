<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="960px" preserveAspectRatio="none" style="width:1525px;height:960px;" version="1.1" viewBox="0 0 1525 960" width="1525px" zoomAndPan="magnify"><defs><filter height="300%" id="f1h7qlw8zatw2e" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="828" x="345.5" y="27.4023">TLS exchange showing client/server access to truststores and keystores (1 way SSL - RFC5246)</text><rect fill="#FFFFFF" filter="url(#f1h7qlw8zatw2e)" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="595.5" x="429" y="90.6875"/><rect fill="#FFFFFF" filter="url(#f1h7qlw8zatw2e)" height="594.9004" style="stroke: #000000; stroke-width: 2.0;" width="1493" x="13" y="209.9297"/><rect fill="#FFFFFF" filter="url(#f1h7qlw8zatw2e)" height="75.9316" style="stroke: #000000; stroke-width: 2.0;" width="595.5" x="429" y="818.8301"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="230" x2="230" y1="73.6875" y2="911.7617"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="364" x2="364" y1="73.6875" y2="911.7617"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="468" x2="468" y1="73.6875" y2="911.7617"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="983.5" x2="983.5" y1="73.6875" y2="911.7617"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1218.5" x2="1218.5" y1="73.6875" y2="911.7617"/><rect fill="#E6E6FA" filter="url(#f1h7qlw8zatw2e)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="171" y="38.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="178" y="58.7344">ClientKeyStore</text><rect fill="#E6E6FA" filter="url(#f1h7qlw8zatw2e)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="171" y="910.7617"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="178" y="931.2969">ClientKeyStore</text><rect fill="#E6E6FA" filter="url(#f1h7qlw8zatw2e)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="299" y="38.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="306" y="58.7344">ClientTrustStore</text><rect fill="#E6E6FA" filter="url(#f1h7qlw8zatw2e)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="126" x="299" y="910.7617"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="112" x="306" y="931.2969">ClientTrustStore</text><rect fill="#E6E6FA" filter="url(#f1h7qlw8zatw2e)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="54" x="439" y="38.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="446" y="58.7344">Client</text><rect fill="#E6E6FA" filter="url(#f1h7qlw8zatw2e)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="54" x="439" y="910.7617"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="40" x="446" y="931.2969">Client</text><rect fill="#E6E6FA" filter="url(#f1h7qlw8zatw2e)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="57" x="953.5" y="38.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="960.5" y="58.7344">Server</text><rect fill="#E6E6FA" filter="url(#f1h7qlw8zatw2e)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="57" x="953.5" y="910.7617"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="960.5" y="931.2969">Server</text><rect fill="#E6E6FA" filter="url(#f1h7qlw8zatw2e)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="1158.5" y="38.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="103" x="1165.5" y="58.7344">ServerKeyStore</text><rect fill="#E6E6FA" filter="url(#f1h7qlw8zatw2e)" height="30.4883" style="stroke: #A80036; stroke-width: 1.5;" width="117" x="1158.5" y="910.7617"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="103" x="1165.5" y="931.2969">ServerKeyStore</text><path d="M429,90.6875 L579,90.6875 L579,97.6875 L569,107.6875 L429,107.6875 L429,90.6875 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="105.2422" style="stroke: #000000; stroke-width: 2.0;" width="595.5" x="429" y="90.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="444" y="104.2559">TCP handshake</text><polygon fill="#A80036" points="972,125.3086,982,129.3086,972,133.3086,976,129.3086" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="468" x2="978" y1="129.3086" y2="129.3086"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="475" y="124.5664">[1]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="495" y="124.5664">SYN</text><polygon fill="#A80036" points="479,154.6191,469,158.6191,479,162.6191,475,158.6191" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="473" x2="983" y1="158.6191" y2="158.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="898" y="153.877">[2]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="918" y="153.877">SYN, ACK</text><polygon fill="#A80036" points="972,183.9297,982,187.9297,972,191.9297,976,187.9297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="468" x2="978" y1="187.9297" y2="187.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="475" y="183.1875">[3]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="26" x="495" y="183.1875">ACK</text><path d="M13,209.9297 L161,209.9297 L161,216.9297 L151,226.9297 L13,226.9297 L13,209.9297 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="594.9004" style="stroke: #000000; stroke-width: 2.0;" width="1493" x="13" y="209.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="103" x="28" y="223.498">TLS handshake</text><polygon fill="#A80036" points="972,244.5508,982,248.5508,972,252.5508,976,248.5508" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="468" x2="978" y1="248.5508" y2="248.5508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="475" y="243.8086">[4]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="73" x="495" y="243.8086">ClientHello</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="395" x="572" y="243.8086">(client-random, TLS version, ciphers, compression,extensions)</text><polygon fill="#A80036" points="1207,273.8613,1217,277.8613,1207,281.8613,1211,277.8613" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="984" x2="1213" y1="277.8613" y2="277.8613"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="991" y="273.1191">[5]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="1011" y="273.1191">get my certificate (private key)</text><path d="M1224,290.8613 L1224,315.8613 L1466,315.8613 L1466,300.8613 L1456,290.8613 L1224,290.8613 " fill="#87CEFA" filter="url(#f1h7qlw8zatw2e)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1456,290.8613 L1456,300.8613 L1466,300.8613 L1456,290.8613 " fill="#87CEFA" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="1230" y="308.4297">Looks for first matching server key</text><polygon fill="#A80036" points="995,342.4824,985,346.4824,995,350.4824,991,346.4824" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="989" x2="1218" y1="346.4824" y2="346.4824"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="1127" y="341.7402">[6]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="1147" y="341.7402">Certificate</text><polygon fill="#A80036" points="479,371.793,469,375.793,479,379.793,475,375.793" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="473" x2="983" y1="375.793" y2="375.793"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="681" y="371.0508">[7]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="701" y="371.0508">ServerHello</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="195" x="782" y="371.0508">(server-random, agreed cipher)</text><polygon fill="#A80036" points="479,401.1035,469,405.1035,479,409.1035,475,405.1035" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="473" x2="983" y1="405.1035" y2="405.1035"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="733" y="400.3613">[8]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69" x="753" y="400.3613">Certificate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="826" y="400.3613">(server certificate chain)</text><polygon fill="#A80036" points="479,430.4141,469,434.4141,479,438.4141,475,434.4141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="473" x2="983" y1="434.4141" y2="434.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="845" y="429.6719">[9]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="865" y="429.6719">ServerHelloDone</text><polygon fill="#A80036" points="241,459.7246,231,463.7246,241,467.7246,237,463.7246" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="235" x2="467" y1="463.7246" y2="463.7246"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="300" y="458.9824">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="328" y="458.9824">retrieve certs to trust</text><polygon fill="#A80036" points="456,489.0352,466,493.0352,456,497.0352,460,493.0352" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="230" x2="462" y1="493.0352" y2="493.0352"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="237" y="488.293">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="265" y="488.293">certificate list</text><path d="M104,506.0352 L104,531.0352 L459,531.0352 L459,516.0352 L449,506.0352 L104,506.0352 " fill="#87CEFA" filter="url(#f1h7qlw8zatw2e)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M449,506.0352 L449,516.0352 L459,516.0352 L449,506.0352 " fill="#87CEFA" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="334" x="110" y="523.6035">validates certificate against it's configured truststore</text><path d="M23,545.3457 L23,570.3457 L459,570.3457 L459,555.3457 L449,545.3457 L23,545.3457 " fill="#87CEFA" filter="url(#f1h7qlw8zatw2e)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M449,545.3457 L449,555.3457 L459,555.3457 L449,545.3457 " fill="#87CEFA" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="415" x="29" y="562.9141">generates a pre-master secret encrypted using server's public key</text><polygon fill="#A80036" points="972,596.9668,982,600.9668,972,604.9668,976,600.9668" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="468" x2="978" y1="600.9668" y2="600.9668"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="475" y="596.2246">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="130" x="503" y="596.2246">ClientKeyExchange</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="637" y="596.2246">(premaster secret)</text><path d="M989,613.9668 L989,638.9668 L1284,638.9668 L1284,623.9668 L1274,613.9668 L989,613.9668 " fill="#87CEFA" filter="url(#f1h7qlw8zatw2e)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1274,613.9668 L1274,623.9668 L1284,623.9668 L1274,613.9668 " fill="#87CEFA" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="274" x="995" y="631.5352">descrypts pre-master key using private key</text><path d="M989,653.2773 L989,678.2773 L1492,678.2773 L1492,663.2773 L1482,653.2773 L989,653.2773 " fill="#87CEFA" filter="url(#f1h7qlw8zatw2e)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1482,653.2773 L1482,663.2773 L1492,663.2773 L1482,653.2773 " fill="#87CEFA" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="482" x="995" y="670.8457">creates Master secret using premaster secret, client-random, server-random</text><polygon fill="#A80036" points="972,704.8984,982,708.8984,972,712.8984,976,708.8984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="468" x2="978" y1="708.8984" y2="708.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="475" y="704.1563">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="503" y="704.1563">ChangeCipherSpec</text><polygon fill="#A80036" points="972,734.209,982,738.209,972,742.209,976,738.209" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="468" x2="978" y1="738.209" y2="738.209"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="475" y="733.4668">[14]</text><path d="M508.3333,724.2923 C507.1428,724.2923 506.1667,725.2684 506.1667,726.459 L506.1667,727.5423 L505.0833,727.5423 L505.0833,731.8757 L511.5833,731.8757 L511.5833,727.5423 L510.5,727.5423 L510.5,726.459 C510.5,725.2684 509.5239,724.2923 508.3333,724.2923 M508.3333,725.3757 C508.9411,725.3757 509.4167,725.8512 509.4167,726.459 L509.4167,727.5423 L507.25,727.5423 L507.25,726.459 C507.25,725.8512 507.7256,725.3757 508.3333,725.3757 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57" x="513.6667" y="733.4668">Finished</text><polygon fill="#A80036" points="479,763.5195,469,767.5195,479,771.5195,475,767.5195" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="473" x2="983" y1="767.5195" y2="767.5195"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="821" y="762.7773">[15]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="849" y="762.7773">ChangeCipherSpec</text><polygon fill="#A80036" points="479,792.8301,469,796.8301,479,800.8301,475,796.8301" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="473" x2="983" y1="796.8301" y2="796.8301"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="881.3333" y="792.0879">[16]</text><path d="M914.6667,782.9134 C913.4761,782.9134 912.5,783.8895 912.5,785.0801 L912.5,786.1634 L911.4167,786.1634 L911.4167,790.4967 L917.9167,790.4967 L917.9167,786.1634 L916.8333,786.1634 L916.8333,785.0801 C916.8333,783.8895 915.8572,782.9134 914.6667,782.9134 M914.6667,783.9967 C915.2744,783.9967 915.75,784.4723 915.75,785.0801 L915.75,786.1634 L913.5833,786.1634 L913.5833,785.0801 C913.5833,784.4723 914.0589,783.9967 914.6667,783.9967 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="57" x="920" y="792.0879">Finished</text><path d="M429,818.8301 L584,818.8301 L584,825.8301 L574,835.8301 L429,835.8301 L429,818.8301 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.9316" style="stroke: #000000; stroke-width: 2.0;" width="595.5" x="429" y="818.8301"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="110" x="444" y="832.3984">Application  Use</text><polygon fill="#A80036" points="972,853.4512,982,857.4512,972,861.4512,976,857.4512" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="468" x2="978" y1="857.4512" y2="857.4512"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="475" y="852.709">[17]</text><path d="M508.3333,843.5345 C507.1428,843.5345 506.1667,844.5106 506.1667,845.7012 L506.1667,846.7845 L505.0833,846.7845 L505.0833,851.1178 L511.5833,851.1178 L511.5833,846.7845 L510.5,846.7845 L510.5,845.7012 C510.5,844.5106 509.5239,843.5345 508.3333,843.5345 M508.3333,844.6178 C508.9411,844.6178 509.4167,845.0934 509.4167,845.7012 L509.4167,846.7845 L507.25,846.7845 L507.25,845.7012 C507.25,845.0934 507.7256,844.6178 508.3333,844.6178 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="517.6667" y="852.709">GET /path/request</text><polygon fill="#A80036" points="479,882.7617,469,886.7617,479,890.7617,475,886.7617" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="473" x2="983" y1="886.7617" y2="886.7617"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="877.3333" y="882.0195">[18]</text><path d="M910.6667,872.8451 C909.4761,872.8451 908.5,873.8211 908.5,875.0117 L908.5,876.0951 L907.4167,876.0951 L907.4167,880.4284 L913.9167,880.4284 L913.9167,876.0951 L912.8333,876.0951 L912.8333,875.0117 C912.8333,873.8211 911.8572,872.8451 910.6667,872.8451 M910.6667,873.9284 C911.2744,873.9284 911.75,874.404 911.75,875.0117 L911.75,876.0951 L909.5833,876.0951 L909.5833,875.0117 C909.5833,874.404 910.0589,873.9284 910.6667,873.9284 " fill="#000000" style="stroke: ; stroke-width: 0.0; stroke-dasharray: ;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="920" y="882.0195">response</text><!--MD5=[9423ad5eb6a7c6b825d1b225132dd5a9]
@startuml

autonumber "[0]"

skinparam noteBackgroundColor LightSkyBlue
skinparam participant {
    backgroundColor Lavender
}
skinparam sequenceMessageAlign direction

title TLS exchange showing client/server access to truststores and keystores (1 way SSL - RFC5246)

participant ClientKeyStore
participant ClientTrustStore
participant Client
participant Server
participant ServerKeyStore

group TCP handshake

    Client -> Server: SYN
    Server - -> Client: SYN, ACK
    Client -> Server: ACK
end

group TLS handshake

    Client -> Server: **ClientHello** (client-random, TLS version, ciphers, compression,extensions)
    Server -> ServerKeyStore: get my certificate (private key)
    note right of ServerKeyStore: Looks for first matching server key
    ServerKeyStore -> Server: Certificate
    Server -> Client: **ServerHello** (server-random, agreed cipher)
    Server -> Client: **Certificate** (server certificate chain)
    Server -> Client: **ServerHelloDone**
    Client -> ClientKeyStore: retrieve certs to trust
    ClientKeyStore -> Client: certificate list
    note left of Client: validates certificate against it's configured truststore
    note left of Client: generates a pre-master secret encrypted using server's public key
    Client -> Server: **ClientKeyExchange** (premaster secret)
    note right of Server: descrypts pre-master key using private key
    note right of Server: creates Master secret using premaster secret, client-random, server-random
    Client -> Server: **ChangeCipherSpec**
    Client -> Server: <&lock-locked>**Finished**
    Server -> Client: **ChangeCipherSpec**
    Server -> Client: <&lock-locked>**Finished**

end

group Application  Use
   Client -> Server: <&lock-locked> GET /path/request
   Server -> Client: <&lock-locked> response
end

@enduml

PlantUML version 1.2020.14(Sat Jun 20 15:14:34 BST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>